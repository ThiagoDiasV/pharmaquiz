{% extends "../base.html" %} 
{% load static %}
{% block content %}
<h1>Pharmaquiz</h1>
{% for question in data %}
    <div class="question-container" id="id-question-{{ question.id }}">
        <h2 class="question-number">Quest√£o {{ question.id }}</h2>
        <p class="question-enunciation">Enunciado: {{ question.enunciation }}</p>
        <p class="question-company">Banca: {{ question.company }}</p>
        <ul>
        {% for option in question.options %}
            <li><input class="option" type="radio" name="{{ question.enunciation }}" value="{{ option.text }}"> {{ option.text }}</li>
        {% endfor %}
        </ul>
        <button class="check-answer-button" id="check-button-{{ question.id }}">Conferir</button>
    </div>
{% endfor %}
<script>
    let data = {{ json_data|safe }};
    let buttons = document.getElementsByClassName("check-answer-button");
    let buttonsCount = buttons.length;
    for (let i = 0; i < buttonsCount; i ++) {
        buttons[i].onclick = function(e) {
            let clickedButton = buttons[i];
            let clickedButtonId = clickedButton.id.charAt(clickedButton.id.length-1);
            for (let index in data) {
                if (data[index].id.toString() === clickedButtonId) {
                    let parentContainer = clickedButton.parentElement;
                    let options = parentContainer.querySelectorAll(".option");
                    let jsonData = data[index];
                    for (let index in jsonData.options) {
                        if (jsonData.options[index].is_correct) {
                            let correctAnswer = jsonData.options[index].text;
                            for (let index in options) {
                                if (options[index].checked && options[index].value === correctAnswer) {
                                    alert('acertou!');
                                }
                            }
                        }
                    }
                }
            }
        };
    }

</script>
<script src="{% static 'js/main.js' %}"></script>
{% endblock %}
